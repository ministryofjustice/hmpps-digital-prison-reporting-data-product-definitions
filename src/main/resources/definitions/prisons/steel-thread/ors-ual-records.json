{
  "id": "klbUU3EABT5OE_4BAMgAISgWcQA",
  "name": "ORS UAL Records",
  "description": "MOV0039 - v00.00.01 Last Modified: 29/02/2016\nThis report retrieves those Prisoners who are currently UAL, along with their PNC, Release Date and Prisoner Addresses",
  "metadata": {
    "version": "1.0.0",
    "tags": ["MOV0039  v00.00.01 DPR"]
  },
  "datasource": [
    {
      "id": "nomis",
      "name": "NOMIS",
      "database": "DIGITAL_PRISON_REPORTING",
      "catalog": "nomis"
    }
  ],
  "dataset": [
    {
      "id": "3376286/DP3",
      "name": "UAL",
      "description": "Sentence",
      "datasource": "nomis",
      "query": "dataset_base_ AS (SELECT DISTINCT AT_OFFENDER.OFFENDER_ID_DISPLAY, AT_OFFENDER.LAST_NAME, AT_OFFENDER.FIRST_NAME, AT_OFFENDER.BIRTH_DATE, AT_OFFENDER_EXTERNAL_MOVEMENTS.MOVEMENT_DATE, AT_OFFENDER_EXTERNAL_MOVEMENTS.MOVEMENT_TIME, AT_MOVEMENT_REASONS.DESCRIPTION, COALESCE(AT_EXT_MOV_FROM_AGY.DESCRIPTION,AT_FROM_CITY_CODES.DESCRIPTION,AT_FROM_ADDRESS_ATTENDED.STREET||' '||AT_FROM_ADDRESS_ATTENDED.LOCALITY||' '||AT_FROM_ADDRESS_ATTENDED.POSTAL_CODE), AT_OFFENDER_PNC.IDENTIFIER, AT_MOV_LOC_FROM_OFFND_LOCTION.DESCRIPTION FROM OMS_OWNER.OFFENDERS AT_OFFENDER, OMS_OWNER.REFERENCE_CODES AT_FROM_CITY_CODES, OMS_OWNER.OFFENDER_BOOKINGS AT_OFFENDER_BOOKING, OMS_OWNER.AGENCY_LOCATIONS AT_EXT_MOV_FROM_AGY, OMS_OWNER.AGENCY_LOCATIONS AT_MOV_LOC_FROM_OFFND_LOCTION, OMS_OWNER.OFFENDER_EXTERNAL_MOVEMENTS AT_OFFENDER_EXTERNAL_MOVEMENTS, OMS_OWNER.MOVEMENT_REASONS AT_MOVEMENT_REASONS, ADDRESSES AT_FROM_ADDRESS_ATTENDED, OMS_OWNER.OFFENDER_IDENTIFIERS AT_OFFENDER_PNC, ( --SELECT -- OFFENDER_BOOK_ID, -- max(MOVEMENT_SEQ) AS MOVEMENT_SEQ, -- FROM_AGY_LOC_ID --FROM -- OMS_OWNER.OFFENDER_EXTERNAL_MOVEMENTS --GROUP BY -- OFFENDER_BOOK_ID, -- FROM_AGY_LOC_ID SELECT OFFENDER_BOOK_ID, MOVEMENT_SEQ, MAX(MOVEMENT_TIME) AS MOVEMENT_TIME, FROM_AGY_LOC_ID FROM OMS_OWNER.OFFENDER_EXTERNAL_MOVEMENTS WHERE ACTIVE_FLAG = 'Y' GROUP BY OFFENDER_BOOK_ID, MOVEMENT_SEQ, FROM_AGY_LOC_ID ) DT_LATEST_EXTERNAL_OUT WHERE ( DT_LATEST_EXTERNAL_OUT.OFFENDER_BOOK_ID=AT_OFFENDER_EXTERNAL_MOVEMENTS.OFFENDER_BOOK_ID and DT_LATEST_EXTERNAL_OUT.MOVEMENT_SEQ=AT_OFFENDER_EXTERNAL_MOVEMENTS.MOVEMENT_SEQ and DT_LATEST_EXTERNAL_OUT.FROM_AGY_LOC_ID=AT_OFFENDER_EXTERNAL_MOVEMENTS.FROM_AGY_LOC_ID ) AND ( AT_OFFENDER.OFFENDER_ID=AT_OFFENDER_BOOKING.OFFENDER_ID ) AND ( AT_OFFENDER_BOOKING.OFFENDER_BOOK_ID=AT_OFFENDER_EXTERNAL_MOVEMENTS.OFFENDER_BOOK_ID(+) ) AND ( AT_OFFENDER_EXTERNAL_MOVEMENTS.MOVEMENT_TYPE=AT_MOVEMENT_REASONS.MOVEMENT_TYPE and AT_OFFENDER_EXTERNAL_MOVEMENTS.MOVEMENT_REASON_CODE=AT_MOVEMENT_REASONS.MOVEMENT_REASON_CODE ) AND ( AT_OFFENDER_EXTERNAL_MOVEMENTS.FROM_AGY_LOC_ID=AT_MOV_LOC_FROM_OFFND_LOCTION.AGY_LOC_ID(+) ) AND ( AT_OFFENDER_PNC.IDENTIFIER_TYPE(+)='PNC' ) AND ( AT_OFFENDER_PNC.OFFENDER_ID(+)=AT_OFFENDER_BOOKING.OFFENDER_ID ) AND ( AT_MOV_LOC_FROM_OFFND_LOCTION.AGENCY_LOCATION_TYPE='INST' ) AND ( AT_OFFENDER_EXTERNAL_MOVEMENTS.FROM_AGY_LOC_ID=AT_EXT_MOV_FROM_AGY.AGY_LOC_ID(+) ) AND ( AT_OFFENDER_EXTERNAL_MOVEMENTS.FROM_CITY=AT_FROM_CITY_CODES.CODE(+) ) AND ( AT_FROM_CITY_CODES.DOMAIN='CITY' or AT_FROM_CITY_CODES.DOMAIN is null ) AND ( AT_OFFENDER_EXTERNAL_MOVEMENTS.FROM_ADDRESS_ID=AT_FROM_ADDRESS_ATTENDED.ADDRESS_ID(+) ) AND ( AT_MOV_LOC_FROM_OFFND_LOCTION.DESCRIPTION IN ('ACKLINGTON (HMP)','ALBANY (HMP)','ALDINGTON (HMP)','ALTCOURSE (HMP)','ASHFIELD (HMP)','ASHWELL (HMP)','ASKHAM GRANGE (HMP & YOI)','AYLESBURY (HMP)','BEDFORD (HMP)','BELMARSH (HMP)','BIRMINGHAM (HMP)','BLAKENHURST (HMP)','BLANTYRE HOUSE (HMP)','BLUNDESTON (HMP)','BRINSFORD (HMP)','BRISTOL (HMP)','BRIXTON (HMP)','BROCKHILL (HMP & YOI)','BRONZEFIELD (HMP)','BUCKLEY HALL (HMP)','BULLINGDON (HMP)','BULLWOOD HALL (HMP)','BURE (HMP)','CAMP HILL (HMP)','CAMPSFIELD HOUSE (HMYOI)','CANTERBURY (HMP)','CARDIFF (HMP)','CASTINGTON (HMP & YOI)','CHANNINGS WOOD (HMP)','CHELMSFORD (HMP)','CLELAND (HMP)','COLCHESTER (HMYOI)','COLDINGLEY (HMP)','COOKHAM WOOD (HMP)','DARTMOOR (HMP)','DEERBOLT (HMPYOI)','DONCASTER (HMP)','DORCHESTER (HMP)','DOVEGATE (HMP)','DOWNVIEW (HMP)','DRAKE HALL (HMP & YOI)','DURHAM (HMP)','Dover Immigration Removal Centre','EAST SUTTON PARK (HMP & YOI)','EASTWOOD PARK (HMP)','EDMUNDS HILL (HMP)','ELMLEY (HMP)','ERLESTOKE (HMP)','EVERTHORPE (HMP)','EXETER (HMP)','FEATHERSTONE (HMP)','FELTHAM (HMP & YOI)','FINNAMORE (HMYOI)','FORD (HMP)','FOREST BANK (HMP & YOI)','FOSTON HALL (HMP)','FRANKLAND (HMP)','FULL SUTTON (HMP)','Foreign Prison','GARTH (HMP)','GARTREE (HMP)','GHOST HOLDING ESTABLISHMENT','GLEN PARVA (HMPYOI & RC)','GLOUCESTER (HMP)','GRENDON (HMP)','GUYS MARSH (HMP)','HATFIELD (HMP & YOI)','HAVERIGG (HMP)','HEWELL GRANGE (HMP)','HIGH DOWN (HMP)','HIGHPOINT (HMP)','HINDLEY (HMP & YOI)','HMP HEWELL','HOLLESLEY BAY (HMP)','HOLLOWAY (HMP)','HOLME HOUSE (HMP)','HULL (HMP)','HUMBER (HMP)','HUNTERCOMBE (HMP)','Haslar Immigration Removal Centre','ISIS HMP/YOI','ISLE OF WIGHT (HMP)','KENNET (HMP)','KINGSTON (HMP)','KIRKHAM (HMP)','KIRKLEVINGTON GRANGE (HMP)','LANCASTER CASTLE (HMP)','LANCASTER FARMS (HMPYOI)','LATCHMERE HOUSE (HMP)','LEEDS (HMP)','LEICESTER (HMP)','LEWES (HMP)','LEYHILL (HMP)','LINCOLN (HMP)','LINDHOLME (HMP)','LITTLEHEY (HMP)','LIVERPOOL (HMP)','LONG LARTIN (HMP)','LOW NEWTON (HMP)','LOWDHAM GRANGE (HMP)','MAIDSTONE (HMP)','MANCHESTER (HMP)','MOORLAND (HMP & YOI)','MORTON HALL IMMIGRATION REMOVAL CENTRE','NEW HALL (HMP)','NORTH SEA CAMP (HMP)','NORTHALLERTON (HMP)','NORTHEYE (HMP)','NORTHUMBERLAND (HMP)','NORWICH (HMP & YOI)','NOTTINGHAM (HMP)','OAKWOOD (HMP)','ONLEY (HMP)','OUTSIDE','OXFORD (HMP)','PARC (HMP)','PARKHURST (HMP)','PENTONVILLE (HMP)','PETERBOROUGH (HMP)','PETERBOROUGH FEMALE HMP','PORTLAND (HMPYOI)','PRESCOED (HMP & YOI)','PRESTON (HMP)','PUCKLECHURCH (HMRC)','RANBY (HMP)','READING (HMP & YOI)','RISLEY (HMP)','ROCHESTER (HMP & YOI)','ROLLESTONE (HMP)','RUDGATE (HMP)','RYE HILL (HMP)','SEND (HMP)','SHEPTON MALLET (HMP)','SHREWSBURY (HMP)','SPRING HILL (HMP)','STAFFORD (HMP)','STANDFORD HILL (HMP)','STOCKEN (HMP)','STOKE HEATH (HMPYOI)','STYAL (HMP & YOI)','SUDBURY (HMP)','SWALESIDE (HMP)','SWANSEA (HMP)','SWINFEN HALL (HMP)','THAMESIDE (HMP)','THE MOUNT (HMP)','THE WEARE (HMP)','THORN CROSS (HMPYOI)','THORP ARCH (HMP)','TRANSFER','The Verne Immigration Removal Centre','UNKNOWN LOCATION','USK (HMP)','WAKEFIELD (HMP)','WANDSWORTH (HMP)','WARREN HILL (HMP)','WAYLAND (HMP)','WEALSTUN (HMP)','WELLINGBOROUGH (HMP)','WERRINGTON (HMPYOI)','WETHERBY (HMPYOI)','WHATTON (HMP)','WHITEMOOR (HMP)','WINCHESTER (HMP)','WOLDS (HMP)','WOODHILL (HMP)','WORMWOOD SCRUBS (HMP)','WYMOTT (HMP)') AND ( DT_LATEST_EXTERNAL_OUT.OFFENDER_BOOK_ID=AT_OFFENDER_EXTERNAL_MOVEMENTS.OFFENDER_BOOK_ID and DT_LATEST_EXTERNAL_OUT.MOVEMENT_SEQ=AT_OFFENDER_EXTERNAL_MOVEMENTS.MOVEMENT_SEQ and DT_LATEST_EXTERNAL_OUT.FROM_AGY_LOC_ID=AT_OFFENDER_EXTERNAL_MOVEMENTS.FROM_AGY_LOC_ID ) AND ( AT_OFFENDER_BOOKING.IN_OUT_STATUS='OUT' ) AND AT_OFFENDER_EXTERNAL_MOVEMENTS.DIRECTION_CODE = 'OUT' AND AT_MOVEMENT_REASONS.DESCRIPTION IN ( 'Abscond','Escape','ABSCOND END OF CUSTODY LICENCE' ) )), dataset_ AS (SELECT FROM dataset_base_)",
      "parameters": [],
      "schema": {
        "field": []
      }
    },
    {
      "id": "3376286/DPd",
      "name": "Sentences",
      "description": "Sentence",
      "datasource": "nomis",
      "query": "dataset_base_ AS (SELECT DISTINCT AT_OFFENDER.OFFENDER_ID_DISPLAY, AT_OFFENDER_RELEASE_DETAILS.RELEASE_DATE, AT_IMPRISON_STATUSES.IMPRISONMENT_STATUS, AT_OFFENCES.DESCRIPTION FROM OMS_OWNER.COURT_EVENTS AT_OFFENDER_COURT_EVENTS, OMS_OWNER.OFFENDERS AT_OFFENDER, OMS_OWNER.OFFENDER_BOOKINGS AT_OFFENDER_BOOKING, OMS_OWNER.AGENCY_LOCATIONS AT_MOV_LOC_FROM_OFFND_LOCTION, OMS_OWNER.OFFENDER_EXTERNAL_MOVEMENTS AT_OFFENDER_EXTERNAL_MOVEMENTS, OMS_OWNER.MOVEMENT_REASONS AT_MOVEMENT_REASONS, OMS_OWNER.IMPRISONMENT_STATUSES AT_IMPRISON_STATUSES, OMS_OWNER.OFFENDER_RELEASE_DETAILS AT_OFFENDER_RELEASE_DETAILS, OMS_OWNER.OFFENCES AT_OFFENCES, ( --SELECT -- OFFENDER_BOOK_ID, -- max(MOVEMENT_SEQ) AS MOVEMENT_SEQ, -- FROM_AGY_LOC_ID --FROM -- OMS_OWNER.OFFENDER_EXTERNAL_MOVEMENTS --GROUP BY -- OFFENDER_BOOK_ID, -- FROM_AGY_LOC_ID SELECT OFFENDER_BOOK_ID, MOVEMENT_SEQ, MAX(MOVEMENT_TIME) AS MOVEMENT_TIME, FROM_AGY_LOC_ID FROM OMS_OWNER.OFFENDER_EXTERNAL_MOVEMENTS WHERE ACTIVE_FLAG = 'Y' GROUP BY OFFENDER_BOOK_ID, MOVEMENT_SEQ, FROM_AGY_LOC_ID ) DT_LATEST_EXTERNAL_OUT, OMS_OWNER.COURT_EVENT_CHARGES AT_COURT_EVENT_CHARGES, OMS_OWNER.OFFENDER_IMPRISON_STATUSES AT_OFFENDER_IMPRISON_STATUSES, OMS_OWNER.OFFENCE_INDICATORS AT_OFFENCE_INDICATORS, OMS_OWNER.OFFENDER_CHARGES AT_OFFENDER_CHARGES, OMS_OWNER.OFFENDER_CASES AT_OFFENDER_CASES WHERE ( DT_LATEST_EXTERNAL_OUT.OFFENDER_BOOK_ID=AT_OFFENDER_EXTERNAL_MOVEMENTS.OFFENDER_BOOK_ID and DT_LATEST_EXTERNAL_OUT.MOVEMENT_SEQ=AT_OFFENDER_EXTERNAL_MOVEMENTS.MOVEMENT_SEQ and DT_LATEST_EXTERNAL_OUT.FROM_AGY_LOC_ID=AT_OFFENDER_EXTERNAL_MOVEMENTS.FROM_AGY_LOC_ID ) AND ( AT_OFFENCES.OFFENCE_CODE=AT_OFFENCE_INDICATORS.OFFENCE_CODE ) AND ( AT_OFFENCES.STATUTE_CODE(+)=AT_OFFENCE_INDICATORS.STATUTE_CODE ) AND ( AT_COURT_EVENT_CHARGES.EVENT_ID(+)=AT_OFFENDER_COURT_EVENTS.EVENT_ID ) AND ( AT_OFFENDER_CHARGES.OFFENDER_CHARGE_ID(+)=AT_COURT_EVENT_CHARGES.OFFENDER_CHARGE_ID ) AND ( AT_OFFENCE_INDICATORS.OFFENCE_CODE=AT_OFFENDER_CHARGES.OFFENCE_CODE ) AND ( AT_OFFENCE_INDICATORS.STATUTE_CODE(+)=AT_OFFENDER_CHARGES.STATUTE_CODE ) AND ( AT_OFFENDER_COURT_EVENTS.CASE_ID=AT_OFFENDER_CASES.CASE_ID ) AND ( AT_OFFENDER.OFFENDER_ID=AT_OFFENDER_BOOKING.OFFENDER_ID ) AND ( AT_OFFENDER_BOOKING.OFFENDER_BOOK_ID=AT_OFFENDER_EXTERNAL_MOVEMENTS.OFFENDER_BOOK_ID(+) ) AND ( AT_OFFENDER_EXTERNAL_MOVEMENTS.MOVEMENT_TYPE=AT_MOVEMENT_REASONS.MOVEMENT_TYPE and AT_OFFENDER_EXTERNAL_MOVEMENTS.MOVEMENT_REASON_CODE=AT_MOVEMENT_REASONS.MOVEMENT_REASON_CODE ) AND ( AT_OFFENDER_BOOKING.OFFENDER_BOOK_ID=AT_OFFENDER_CASES.OFFENDER_BOOK_ID(+) ) AND ( AT_OFFENDER_IMPRISON_STATUSES.OFFENDER_BOOK_ID(+)=AT_OFFENDER_BOOKING.OFFENDER_BOOK_ID ) AND ( AT_OFFENDER_IMPRISON_STATUSES.LATEST_STATUS='Y' or AT_OFFENDER_IMPRISON_STATUSES.LATEST_STATUS is null ) AND ( AT_OFFENDER_BOOKING.OFFENDER_BOOK_ID=AT_OFFENDER_RELEASE_DETAILS.OFFENDER_BOOK_ID(+) ) AND ( AT_OFFENDER_EXTERNAL_MOVEMENTS.FROM_AGY_LOC_ID=AT_MOV_LOC_FROM_OFFND_LOCTION.AGY_LOC_ID(+) ) AND ( AT_IMPRISON_STATUSES.IMPRISONMENT_STATUS(+)=AT_OFFENDER_IMPRISON_STATUSES.IMPRISONMENT_STATUS ) AND ( AT_MOV_LOC_FROM_OFFND_LOCTION.AGENCY_LOCATION_TYPE='INST' ) AND ( AT_MOV_LOC_FROM_OFFND_LOCTION.DESCRIPTION IN ('ACKLINGTON (HMP)','ALBANY (HMP)','ALDINGTON (HMP)','ALTCOURSE (HMP)','ASHFIELD (HMP)','ASHWELL (HMP)','ASKHAM GRANGE (HMP & YOI)','AYLESBURY (HMP)','BEDFORD (HMP)','BELMARSH (HMP)','BIRMINGHAM (HMP)','BLAKENHURST (HMP)','BLANTYRE HOUSE (HMP)','BLUNDESTON (HMP)','BRINSFORD (HMP)','BRISTOL (HMP)','BRIXTON (HMP)','BROCKHILL (HMP & YOI)','BRONZEFIELD (HMP)','BUCKLEY HALL (HMP)','BULLINGDON (HMP)','BULLWOOD HALL (HMP)','BURE (HMP)','CAMP HILL (HMP)','CAMPSFIELD HOUSE (HMYOI)','CANTERBURY (HMP)','CARDIFF (HMP)','CASTINGTON (HMP & YOI)','CHANNINGS WOOD (HMP)','CHELMSFORD (HMP)','CLELAND (HMP)','COLCHESTER (HMYOI)','COLDINGLEY (HMP)','COOKHAM WOOD (HMP)','DARTMOOR (HMP)','DEERBOLT (HMPYOI)','DONCASTER (HMP)','DORCHESTER (HMP)','DOVEGATE (HMP)','DOWNVIEW (HMP)','DRAKE HALL (HMP & YOI)','DURHAM (HMP)','Dover Immigration Removal Centre','EAST SUTTON PARK (HMP & YOI)','EASTWOOD PARK (HMP)','EDMUNDS HILL (HMP)','ELMLEY (HMP)','ERLESTOKE (HMP)','EVERTHORPE (HMP)','EXETER (HMP)','FEATHERSTONE (HMP)','FELTHAM (HMP & YOI)','FINNAMORE (HMYOI)','FORD (HMP)','FOREST BANK (HMP & YOI)','FOSTON HALL (HMP)','FRANKLAND (HMP)','FULL SUTTON (HMP)','Foreign Prison','GARTH (HMP)','GARTREE (HMP)','GHOST HOLDING ESTABLISHMENT','GLEN PARVA (HMPYOI & RC)','GLOUCESTER (HMP)','GRENDON (HMP)','GUYS MARSH (HMP)','HATFIELD (HMP & YOI)','HAVERIGG (HMP)','HEWELL GRANGE (HMP)','HIGH DOWN (HMP)','HIGHPOINT (HMP)','HINDLEY (HMP & YOI)','HMP HEWELL','HOLLESLEY BAY (HMP)','HOLLOWAY (HMP)','HOLME HOUSE (HMP)','HULL (HMP)','HUMBER (HMP)','HUNTERCOMBE (HMP)','Haslar Immigration Removal Centre','ISIS HMP/YOI','ISLE OF WIGHT (HMP)','KENNET (HMP)','KINGSTON (HMP)','KIRKHAM (HMP)','KIRKLEVINGTON GRANGE (HMP)','LANCASTER CASTLE (HMP)','LANCASTER FARMS (HMPYOI)','LATCHMERE HOUSE (HMP)','LEEDS (HMP)','LEICESTER (HMP)','LEWES (HMP)','LEYHILL (HMP)','LINCOLN (HMP)','LINDHOLME (HMP)','LITTLEHEY (HMP)','LIVERPOOL (HMP)','LONG LARTIN (HMP)','LOW NEWTON (HMP)','LOWDHAM GRANGE (HMP)','MAIDSTONE (HMP)','MANCHESTER (HMP)','MOORLAND (HMP & YOI)','MORTON HALL IMMIGRATION REMOVAL CENTRE','NEW HALL (HMP)','NORTH SEA CAMP (HMP)','NORTHALLERTON (HMP)','NORTHEYE (HMP)','NORTHUMBERLAND (HMP)','NORWICH (HMP & YOI)','NOTTINGHAM (HMP)','OAKWOOD (HMP)','ONLEY (HMP)','OUTSIDE','OXFORD (HMP)','PARC (HMP)','PARKHURST (HMP)','PENTONVILLE (HMP)','PETERBOROUGH (HMP)','PETERBOROUGH FEMALE HMP','PORTLAND (HMPYOI)','PRESCOED (HMP & YOI)','PRESTON (HMP)','PUCKLECHURCH (HMRC)','RANBY (HMP)','READING (HMP & YOI)','RISLEY (HMP)','ROCHESTER (HMP & YOI)','ROLLESTONE (HMP)','RUDGATE (HMP)','RYE HILL (HMP)','SEND (HMP)','SHEPTON MALLET (HMP)','SHREWSBURY (HMP)','SPRING HILL (HMP)','STAFFORD (HMP)','STANDFORD HILL (HMP)','STOCKEN (HMP)','STOKE HEATH (HMPYOI)','STYAL (HMP & YOI)','SUDBURY (HMP)','SWALESIDE (HMP)','SWANSEA (HMP)','SWINFEN HALL (HMP)','THAMESIDE (HMP)','THE MOUNT (HMP)','THE WEARE (HMP)','THORN CROSS (HMPYOI)','THORP ARCH (HMP)','TRANSFER','The Verne Immigration Removal Centre','UNKNOWN LOCATION','USK (HMP)','WAKEFIELD (HMP)','WANDSWORTH (HMP)','WARREN HILL (HMP)','WAYLAND (HMP)','WEALSTUN (HMP)','WELLINGBOROUGH (HMP)','WERRINGTON (HMPYOI)','WETHERBY (HMPYOI)','WHATTON (HMP)','WHITEMOOR (HMP)','WINCHESTER (HMP)','WOLDS (HMP)','WOODHILL (HMP)','WORMWOOD SCRUBS (HMP)','WYMOTT (HMP)') AND ( DT_LATEST_EXTERNAL_OUT.OFFENDER_BOOK_ID=AT_OFFENDER_EXTERNAL_MOVEMENTS.OFFENDER_BOOK_ID and DT_LATEST_EXTERNAL_OUT.MOVEMENT_SEQ=AT_OFFENDER_EXTERNAL_MOVEMENTS.MOVEMENT_SEQ and DT_LATEST_EXTERNAL_OUT.FROM_AGY_LOC_ID=AT_OFFENDER_EXTERNAL_MOVEMENTS.FROM_AGY_LOC_ID ) AND ( AT_OFFENDER_BOOKING.IN_OUT_STATUS='OUT' ) AND AT_COURT_EVENT_CHARGES.MOST_SERIOUS_FLAG = 'Y' AND AT_OFFENDER_EXTERNAL_MOVEMENTS.DIRECTION_CODE = 'OUT' AND AT_MOVEMENT_REASONS.DESCRIPTION IN ( 'Abscond','Escape','ABSCOND END OF CUSTODY LICENCE' ) )), dataset_ AS (SELECT FROM dataset_base_)",
      "parameters": [],
      "schema": {
        "field": []
      }
    },
    {
      "id": "3376286/DPe",
      "name": "Addresses",
      "description": "Sentence",
      "datasource": "nomis",
      "query": "dataset_base_ AS (SELECT DISTINCT AT_OFFENDER.OFFENDER_ID_DISPLAY, AT_OFFENDER.LAST_NAME, AT_OFFENDER.FIRST_NAME, AT_OFFENDER_ADDRESSES.FLAT, AT_OFFENDER_ADDRESSES.STREET, AT_OFFENDER_ADDRESSES.LOCALITY, AT_OFFENDER_ADDRESSES.POSTAL_CODE, AT_OFF_ADD_COUNTY.DESCRIPTION, AT_OFF_ADD_CITY.DESCRIPTION, AT_OFFENDER_ADDRESSES.NO_FIXED_ADDRESS_FLAG, AT_OFFENDER_ADDRESSES.PRIMARY_FLAG, AT_OFFENDER_ADDRESSES.START_DATE, AT_OFFENDER_ADDRESS_USAGES.ACTIVE_FLAG, AT_ADDRESS_TYPES.DESCRIPTION, AT_OFFENDER_ADDRESSES.CREATE_DATETIME FROM OMS_OWNER.ADDRESSES AT_OFFENDER_ADDRESSES, OMS_OWNER.OFFENDERS AT_OFFENDER, OMS_OWNER.REFERENCE_CODES AT_OFF_ADD_COUNTY, OMS_OWNER.REFERENCE_CODES AT_OFF_ADD_CITY, OMS_OWNER.REFERENCE_CODES AT_ADDRESS_TYPES, OMS_OWNER.ADDRESS_USAGES AT_OFFENDER_ADDRESS_USAGES, OMS_OWNER.OFFENDER_BOOKINGS AT_OFFENDER_BOOKING, OMS_OWNER.AGENCY_LOCATIONS AT_MOV_LOC_FROM_OFFND_LOCTION, OMS_OWNER.OFFENDER_EXTERNAL_MOVEMENTS AT_OFFENDER_EXTERNAL_MOVEMENTS, OMS_OWNER.MOVEMENT_REASONS AT_MOVEMENT_REASONS, ( --SELECT -- OFFENDER_BOOK_ID, -- max(MOVEMENT_SEQ) AS MOVEMENT_SEQ, -- FROM_AGY_LOC_ID --FROM -- OMS_OWNER.OFFENDER_EXTERNAL_MOVEMENTS --GROUP BY -- OFFENDER_BOOK_ID, -- FROM_AGY_LOC_ID SELECT OFFENDER_BOOK_ID, MOVEMENT_SEQ, MAX(MOVEMENT_TIME) AS MOVEMENT_TIME, FROM_AGY_LOC_ID FROM OMS_OWNER.OFFENDER_EXTERNAL_MOVEMENTS WHERE ACTIVE_FLAG = 'Y' GROUP BY OFFENDER_BOOK_ID, MOVEMENT_SEQ, FROM_AGY_LOC_ID ) DT_LATEST_EXTERNAL_OUT WHERE ( DT_LATEST_EXTERNAL_OUT.OFFENDER_BOOK_ID=AT_OFFENDER_EXTERNAL_MOVEMENTS.OFFENDER_BOOK_ID and DT_LATEST_EXTERNAL_OUT.MOVEMENT_SEQ=AT_OFFENDER_EXTERNAL_MOVEMENTS.MOVEMENT_SEQ and DT_LATEST_EXTERNAL_OUT.FROM_AGY_LOC_ID=AT_OFFENDER_EXTERNAL_MOVEMENTS.FROM_AGY_LOC_ID ) AND ( AT_OFFENDER.OFFENDER_ID=AT_OFFENDER_BOOKING.OFFENDER_ID ) AND ( AT_OFFENDER_ADDRESSES.OWNER_ID(+)=AT_OFFENDER.ROOT_OFFENDER_ID ) AND ( AT_OFFENDER_BOOKING.OFFENDER_BOOK_ID=AT_OFFENDER_EXTERNAL_MOVEMENTS.OFFENDER_BOOK_ID(+) ) AND ( AT_OFFENDER_ADDRESS_USAGES.ADDRESS_ID(+)=AT_OFFENDER_ADDRESSES.ADDRESS_ID ) AND ( AT_OFFENDER_EXTERNAL_MOVEMENTS.MOVEMENT_TYPE=AT_MOVEMENT_REASONS.MOVEMENT_TYPE and AT_OFFENDER_EXTERNAL_MOVEMENTS.MOVEMENT_REASON_CODE=AT_MOVEMENT_REASONS.MOVEMENT_REASON_CODE ) AND ( AT_OFF_ADD_CITY.CODE(+)=AT_OFFENDER_ADDRESSES.CITY_CODE ) AND ( AT_OFF_ADD_CITY.DOMAIN='CITY' OR AT_OFF_ADD_CITY.DOMAIN IS NULL ) AND ( AT_OFF_ADD_COUNTY.CODE(+)=AT_OFFENDER_ADDRESSES.COUNTY_CODE ) AND ( AT_OFF_ADD_COUNTY.DOMAIN='COUNTY' OR AT_OFF_ADD_COUNTY.DOMAIN IS NULL ) AND ( AT_OFFENDER_EXTERNAL_MOVEMENTS.FROM_AGY_LOC_ID=AT_MOV_LOC_FROM_OFFND_LOCTION.AGY_LOC_ID(+) ) AND ( AT_MOV_LOC_FROM_OFFND_LOCTION.AGENCY_LOCATION_TYPE='INST' ) AND ( AT_ADDRESS_TYPES.DOMAIN='ADDRESS_TYPE' ) AND ( AT_ADDRESS_TYPES.CODE=AT_OFFENDER_ADDRESS_USAGES.ADDRESS_USAGE ) AND ( AT_MOV_LOC_FROM_OFFND_LOCTION.DESCRIPTION IN ('ACKLINGTON (HMP)','ALBANY (HMP)','ALDINGTON (HMP)','ALTCOURSE (HMP)','ASHFIELD (HMP)','ASHWELL (HMP)','ASKHAM GRANGE (HMP & YOI)','AYLESBURY (HMP)','BEDFORD (HMP)','BELMARSH (HMP)','BIRMINGHAM (HMP)','BLAKENHURST (HMP)','BLANTYRE HOUSE (HMP)','BLUNDESTON (HMP)','BRINSFORD (HMP)','BRISTOL (HMP)','BRIXTON (HMP)','BROCKHILL (HMP & YOI)','BRONZEFIELD (HMP)','BUCKLEY HALL (HMP)','BULLINGDON (HMP)','BULLWOOD HALL (HMP)','BURE (HMP)','CAMP HILL (HMP)','CAMPSFIELD HOUSE (HMYOI)','CANTERBURY (HMP)','CARDIFF (HMP)','CASTINGTON (HMP & YOI)','CHANNINGS WOOD (HMP)','CHELMSFORD (HMP)','CLELAND (HMP)','COLCHESTER (HMYOI)','COLDINGLEY (HMP)','COOKHAM WOOD (HMP)','DARTMOOR (HMP)','DEERBOLT (HMPYOI)','DONCASTER (HMP)','DORCHESTER (HMP)','DOVEGATE (HMP)','DOWNVIEW (HMP)','DRAKE HALL (HMP & YOI)','DURHAM (HMP)','Dover Immigration Removal Centre','EAST SUTTON PARK (HMP & YOI)','EASTWOOD PARK (HMP)','EDMUNDS HILL (HMP)','ELMLEY (HMP)','ERLESTOKE (HMP)','EVERTHORPE (HMP)','EXETER (HMP)','FEATHERSTONE (HMP)','FELTHAM (HMP & YOI)','FINNAMORE (HMYOI)','FORD (HMP)','FOREST BANK (HMP & YOI)','FOSTON HALL (HMP)','FRANKLAND (HMP)','FULL SUTTON (HMP)','Foreign Prison','GARTH (HMP)','GARTREE (HMP)','GHOST HOLDING ESTABLISHMENT','GLEN PARVA (HMPYOI & RC)','GLOUCESTER (HMP)','GRENDON (HMP)','GUYS MARSH (HMP)','HATFIELD (HMP & YOI)','HAVERIGG (HMP)','HEWELL GRANGE (HMP)','HIGH DOWN (HMP)','HIGHPOINT (HMP)','HINDLEY (HMP & YOI)','HMP HEWELL','HOLLESLEY BAY (HMP)','HOLLOWAY (HMP)','HOLME HOUSE (HMP)','HULL (HMP)','HUMBER (HMP)','HUNTERCOMBE (HMP)','Haslar Immigration Removal Centre','ISIS HMP/YOI','ISLE OF WIGHT (HMP)','KENNET (HMP)','KINGSTON (HMP)','KIRKHAM (HMP)','KIRKLEVINGTON GRANGE (HMP)','LANCASTER CASTLE (HMP)','LANCASTER FARMS (HMPYOI)','LATCHMERE HOUSE (HMP)','LEEDS (HMP)','LEICESTER (HMP)','LEWES (HMP)','LEYHILL (HMP)','LINCOLN (HMP)','LINDHOLME (HMP)','LITTLEHEY (HMP)','LIVERPOOL (HMP)','LONG LARTIN (HMP)','LOW NEWTON (HMP)','LOWDHAM GRANGE (HMP)','MAIDSTONE (HMP)','MANCHESTER (HMP)','MOORLAND (HMP & YOI)','MORTON HALL IMMIGRATION REMOVAL CENTRE','NEW HALL (HMP)','NORTH SEA CAMP (HMP)','NORTHALLERTON (HMP)','NORTHEYE (HMP)','NORTHUMBERLAND (HMP)','NORWICH (HMP & YOI)','NOTTINGHAM (HMP)','OAKWOOD (HMP)','ONLEY (HMP)','OUTSIDE','OXFORD (HMP)','PARC (HMP)','PARKHURST (HMP)','PENTONVILLE (HMP)','PETERBOROUGH (HMP)','PETERBOROUGH FEMALE HMP','PORTLAND (HMPYOI)','PRESCOED (HMP & YOI)','PRESTON (HMP)','PUCKLECHURCH (HMRC)','RANBY (HMP)','READING (HMP & YOI)','RISLEY (HMP)','ROCHESTER (HMP & YOI)','ROLLESTONE (HMP)','RUDGATE (HMP)','RYE HILL (HMP)','SEND (HMP)','SHEPTON MALLET (HMP)','SHREWSBURY (HMP)','SPRING HILL (HMP)','STAFFORD (HMP)','STANDFORD HILL (HMP)','STOCKEN (HMP)','STOKE HEATH (HMPYOI)','STYAL (HMP & YOI)','SUDBURY (HMP)','SWALESIDE (HMP)','SWANSEA (HMP)','SWINFEN HALL (HMP)','THAMESIDE (HMP)','THE MOUNT (HMP)','THE WEARE (HMP)','THORN CROSS (HMPYOI)','THORP ARCH (HMP)','TRANSFER','The Verne Immigration Removal Centre','UNKNOWN LOCATION','USK (HMP)','WAKEFIELD (HMP)','WANDSWORTH (HMP)','WARREN HILL (HMP)','WAYLAND (HMP)','WEALSTUN (HMP)','WELLINGBOROUGH (HMP)','WERRINGTON (HMPYOI)','WETHERBY (HMPYOI)','WHATTON (HMP)','WHITEMOOR (HMP)','WINCHESTER (HMP)','WOLDS (HMP)','WOODHILL (HMP)','WORMWOOD SCRUBS (HMP)','WYMOTT (HMP)') AND ( DT_LATEST_EXTERNAL_OUT.OFFENDER_BOOK_ID=AT_OFFENDER_EXTERNAL_MOVEMENTS.OFFENDER_BOOK_ID and DT_LATEST_EXTERNAL_OUT.MOVEMENT_SEQ=AT_OFFENDER_EXTERNAL_MOVEMENTS.MOVEMENT_SEQ and DT_LATEST_EXTERNAL_OUT.FROM_AGY_LOC_ID=AT_OFFENDER_EXTERNAL_MOVEMENTS.FROM_AGY_LOC_ID ) AND ( AT_OFFENDER_BOOKING.IN_OUT_STATUS='OUT' ) AND AT_OFFENDER_EXTERNAL_MOVEMENTS.DIRECTION_CODE = 'OUT' AND AT_MOVEMENT_REASONS.DESCRIPTION IN ( 'Abscond','Escape','ABSCOND END OF CUSTODY LICENCE' ) )), dataset_ AS (SELECT FROM dataset_base_)",
      "parameters": [],
      "schema": {
        "field": []
      }
    }
  ],
  "policy": [
    {
      "id": "access",
      "type": "access",
      "rule": [
        {
          "effect": "permit",
          "condition": [
            {
              "match": ["${role}", "ROLE_PRISONS_REPORTING_USER"]
            }
          ]
        }
      ]
    }
  ],
  "report": [
    {
      "id": "167005.RS",
      "name": "By Date",
      "classification": "OFFICIAL",
      "version": "1.0.0",
      "render": "HTML",
      "dataset": "3376286/DP3",
      "specification": {
        "template": "list",
        "field": [
          {
            "name": "$ref:DP3.DO10837",
            "display": "",
            "formula": "",
            "visible": "true",
            "sortable": true,
            "defaultsort": false
          },
          {
            "name": "$ref:DP3.DO1059a",
            "display": "",
            "formula": "",
            "visible": "true",
            "sortable": true,
            "defaultsort": false
          },
          {
            "name": "$ref:DP3.DO1083b",
            "display": "",
            "formula": "",
            "visible": "true",
            "sortable": true,
            "defaultsort": false
          },
          {
            "name": "$ref:DP3.DO10075",
            "display": "",
            "formula": "",
            "visible": "true",
            "sortable": true,
            "defaultsort": false
          },
          {
            "name": "$ref:v_Main_legal_status",
            "display": "",
            "formula": "=[Main Legal Status]",
            "visible": "true",
            "sortable": true,
            "defaultsort": false
          },
          {
            "name": "$ref:DP3.DO10b9b",
            "display": "",
            "formula": "",
            "visible": "true",
            "sortable": true,
            "defaultsort": false
          },
          {
            "name": "$ref:DP3.DO10d98",
            "display": "",
            "formula": "",
            "visible": "true",
            "sortable": true,
            "defaultsort": false
          },
          {
            "name": "$ref:v_Offence",
            "display": "",
            "formula": "=[Offence Description]",
            "visible": "true",
            "sortable": true,
            "defaultsort": false
          },
          {
            "name": "$ref:v_Release_date",
            "display": "",
            "formula": "=[Release Date]",
            "visible": "true",
            "sortable": true,
            "defaultsort": false
          }
        ]
      }
    },
    {
      "id": "169241.RS",
      "name": "By Surname",
      "classification": "OFFICIAL",
      "version": "1.0.0",
      "render": "HTML",
      "dataset": "3376286/DP3",
      "specification": {
        "template": "list",
        "field": [
          {
            "name": "$ref:DP3.DO10837",
            "display": "",
            "formula": "",
            "visible": "true",
            "sortable": true,
            "defaultsort": false
          },
          {
            "name": "$ref:DP3.DO1059a",
            "display": "",
            "formula": "",
            "visible": "true",
            "sortable": true,
            "defaultsort": false
          },
          {
            "name": "$ref:DP3.DO1083b",
            "display": "",
            "formula": "",
            "visible": "true",
            "sortable": true,
            "defaultsort": false
          },
          {
            "name": "$ref:DP3.DO10075",
            "display": "",
            "formula": "",
            "visible": "true",
            "sortable": true,
            "defaultsort": false
          },
          {
            "name": "$ref:v_Main_legal_status",
            "display": "",
            "formula": "=[Main Legal Status]",
            "visible": "true",
            "sortable": true,
            "defaultsort": false
          },
          {
            "name": "$ref:DP3.DO10b9b",
            "display": "",
            "formula": "",
            "visible": "true",
            "sortable": true,
            "defaultsort": false
          },
          {
            "name": "$ref:DP3.DO10d98",
            "display": "",
            "formula": "",
            "visible": "true",
            "sortable": true,
            "defaultsort": false
          },
          {
            "name": "$ref:v_Offence",
            "display": "",
            "formula": "=[Offence Description]",
            "visible": "true",
            "sortable": true,
            "defaultsort": false
          },
          {
            "name": "$ref:v_Release_date",
            "display": "",
            "formula": "=[Release Date]",
            "visible": "true",
            "sortable": true,
            "defaultsort": false
          }
        ]
      }
    },
    {
      "id": "169305.RS",
      "name": "By Establishment",
      "classification": "OFFICIAL",
      "version": "1.0.0",
      "render": "HTML",
      "dataset": "3376286/DP3",
      "specification": {
        "template": "list",
        "field": [
          {
            "name": "$ref:DP3.DO10837",
            "display": "",
            "formula": "",
            "visible": "true",
            "sortable": true,
            "defaultsort": false
          },
          {
            "name": "$ref:DP3.DO1059a",
            "display": "",
            "formula": "",
            "visible": "true",
            "sortable": true,
            "defaultsort": false
          },
          {
            "name": "$ref:DP3.DO1083b",
            "display": "",
            "formula": "",
            "visible": "true",
            "sortable": true,
            "defaultsort": false
          },
          {
            "name": "$ref:DP3.DO10075",
            "display": "",
            "formula": "",
            "visible": "true",
            "sortable": true,
            "defaultsort": false
          },
          {
            "name": "$ref:v_Main_legal_status",
            "display": "",
            "formula": "=[Main Legal Status]",
            "visible": "true",
            "sortable": true,
            "defaultsort": false
          },
          {
            "name": "$ref:DP3.DO10b9b",
            "display": "",
            "formula": "",
            "visible": "true",
            "sortable": true,
            "defaultsort": false
          },
          {
            "name": "$ref:DP3.DO10d98",
            "display": "",
            "formula": "",
            "visible": "true",
            "sortable": true,
            "defaultsort": false
          },
          {
            "name": "$ref:v_Offence",
            "display": "",
            "formula": "=[Offence Description]",
            "visible": "true",
            "sortable": true,
            "defaultsort": false
          },
          {
            "name": "$ref:v_Release_date",
            "display": "",
            "formula": "=[Release Date]",
            "visible": "true",
            "sortable": true,
            "defaultsort": false
          }
        ]
      }
    },
    {
      "id": "169055.RS",
      "name": "Addresses",
      "classification": "OFFICIAL",
      "version": "1.0.0",
      "render": "HTML",
      "dataset": "3376286/DPe",
      "specification": {
        "template": "list",
        "field": [
          {
            "name": "$ref:DPe.DO10dbc",
            "display": "",
            "formula": "",
            "visible": "true",
            "sortable": true,
            "defaultsort": false
          },
          {
            "name": "$ref:DPe.DO10dbe",
            "display": "",
            "formula": "",
            "visible": "true",
            "sortable": true,
            "defaultsort": false
          },
          {
            "name": "$ref:DPe.DO10825",
            "display": "",
            "formula": "",
            "visible": "true",
            "sortable": true,
            "defaultsort": false
          },
          {
            "name": "$ref:DPe.DO10827",
            "display": "",
            "formula": "",
            "visible": "true",
            "sortable": true,
            "defaultsort": false
          },
          {
            "name": "$ref:DPe.DO10828",
            "display": "",
            "formula": "",
            "visible": "true",
            "sortable": true,
            "defaultsort": false
          },
          {
            "name": "$ref:DPe.DO10dbf",
            "display": "",
            "formula": "",
            "visible": "true",
            "sortable": true,
            "defaultsort": false
          },
          {
            "name": "$ref:DPe.DO10826",
            "display": "",
            "formula": "",
            "visible": "true",
            "sortable": true,
            "defaultsort": false
          },
          {
            "name": "$ref:DPe.DO1089e",
            "display": "",
            "formula": "",
            "visible": "true",
            "sortable": true,
            "defaultsort": false
          },
          {
            "name": "$ref:DPe.DO10a07",
            "display": "",
            "formula": "",
            "visible": "true",
            "sortable": true,
            "defaultsort": false
          },
          {
            "name": "$ref:DPe.DO10d7d",
            "display": "",
            "formula": "",
            "visible": "true",
            "sortable": true,
            "defaultsort": false
          },
          {
            "name": "$ref:DPe.DO10dbb",
            "display": "",
            "formula": "",
            "visible": "true",
            "sortable": true,
            "defaultsort": false
          }
        ]
      }
    },
    {
      "id": "168008.RS",
      "name": "Summary",
      "classification": "OFFICIAL",
      "version": "1.0.0",
      "render": "HTML",
      "dataset": "3376286/DP3",
      "specification": {
        "template": "list",
        "field": [
          {
            "name": "$ref:DP3.DO10d98",
            "display": "",
            "formula": "",
            "visible": "true",
            "sortable": true,
            "defaultsort": false
          },
          {
            "name": "$ref:DP3.DO1083b",
            "display": "",
            "formula": "",
            "visible": "true",
            "sortable": true,
            "defaultsort": false
          }
        ]
      }
    }
  ]
}
